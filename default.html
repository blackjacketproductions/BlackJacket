<!doctype html>
<html lang="en">
<head>
    <title>Harness Test</title>
    <meta charset="utf-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="http://connect.facebook.net/en_US/all.js" type="text/javascript"></script>
    <script src="scripts/main.js" type="text/javascript"></script>
    <script src="scripts/Facebook.js" type="text/javascript"></script>
    <script src="scripts/FacebookUser.js" type="text/javascript"></script>
    <script src="scripts/LoggedInUser.js" type="text/javascript"></script>
    <script src="scripts/IImageSource.js" type="text/javascript"></script>
    <script src="scripts/FacebookImageSource.js" type="text/javascript"></script>
    <script src="scripts/LocalImageSource.js" type="text/javascript"></script>
    <script src="scripts/IMeme.js" type="text/javascript"></script>
    <script src="scripts/View.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/3.3.0/build/cssreset/reset-min.css">
    <link rel="stylesheet" href="css/fbStyles.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<div id="fb-root"></div>

<script type="text/javascript">

    var currentSession = new LoggedInUser();
    var facebook = new Facebook();
    var view = new View();


    $(document).ready(function() {

        //Authenticate the user with Facebook
        facebook.Authenticate(function(response) {
            if (response.status === 'connected') {
                currentSession.access_token = response.authResponse.accessToken;
                currentSession.GetDetails(function(){});
                currentSession.GetFriends(function(){});
            }
            else {
                facebook.Login(function(response){
                    //
                });
            }

        });

        //hide 2nd section
        $("#sbcImageEditor .storyBoardContent").hide();
        $("#sbcPhotoSelector .storyBoardContent").hide();

        $("#sourceFb").click(function(){
            $("#sbcPhotoSelector .storyBoardContent").show("slow");
            $("#sbcImageSource .storyBoardContent").hide("slow");
            currentSession.SetImageSourceType(FacebookImageSourceType);
            //view.DrawFriendsAutoComplete(currentSession.loggedInFacebookUserFriends);

            facebook.GetAlbums(currentSession.loggedInFacebookUser.id, function(data) {
                currentSession.imageSource.friendFacebookUser = currentSession.loggedInFacebookUser.id;
                view.DrawAlbums(data, function(item){
                    $("#albumsGrid").hide();
                    currentSession.imageSource.friendAlbumId = item.id;
                    facebook.GetPhotos(item.id, function(data){
                        view.DrawPhotos(data, function(item){
                            currentSession.imageSource.friendPhotoId = item.id;
                            //imageObj.src = currentSession.imageSource.GetImage();
                        });
                    });
                });
            });
        });

        $("#sourcePc").click(function(){
            $("#sbcImageEditor .storyBoardContent").show("slow");
            $("#sbcImageSource .storyBoardContent").hide("slow");
            currentSession.SetImageSourceType(LocalImageSourceType);
            $("#filepicker").click();
        });
    });

</script>

<div class="appBody">
    <div id="topBar" class="baseContent">
        Fail a Friend!
        <div class="fb-login-button" data-show-faces="true" data-width="210" data-max-rows="1">Login with Facebook</div>
    </div>
    <div id="sbcImageSource" class="baseContent">
        <h3>Step 1 - Where is your image coming from?</h3>
        <div class="storyBoardContent">
            <img id="sourceFb" class="bigTile" src="images/fb_logo.png" title="Select from Facebook" />
            <img id="sourcePc" class="bigTile" src="images/pc_logo.png" title="Select from My Computer" />
        </div>
    </div>

    <div id="sbcPhotoSelector" class="baseContent">
        <h3>Step 2 - Find a photo</h3>
        <div class="storyBoardContent">
            <div id="albumsGrid" class="photoGrid"></div>
            <div id="photosGrid" class="photoGrid"></div>
        </div>
    </div>

    <div id="sbcImageEditor" class="baseContent">
        <h3>Step 3 - Fail your Friend</h3>
        <div class="storyBoardContent">
            <canvas width="760" height="600" id="demotivationalcanvas">

            </canvas>
            <form>
                <p>
                    <label for="posterTitleTextBox">Title:</label>
                    <input id="posterTitleTextBox" type="text" value="Hairy Nuts">
                </p>

                <p>
                    <label for="posterWittyCommentTextBox">Witty Comment:</label>
                    <input id="posterWittyCommentTextBox" type="text" value="I like them this much!!">
                </p>

                <p>
                    <input type="button" id="previewButton" value="Preview">
                </p>
            </form>
        </div>
    </div>
</div>

<div class="hiddenContent">
    <input type="file" id="filepicker" onchange="currentSession.imageSource.ProcessFile(this.files[0])">
</div>

</body>
</html>
